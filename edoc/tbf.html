<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Module tbf</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="EDoc">
</head>
<body bgcolor="white">
<div class="navbar"><a name="#navbar_top"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<hr>

<h1>Module tbf</h1>
<ul class="index"><li><a href="#description">Description</a></li><li><a href="#index">Function Index</a></li><li><a href="#functions">Function Details</a></li></ul>Functions for Thrift(Binary)&lt;-&gt;Erlang data conversion.


<h2><a name="description">Description</a></h2><p>Functions for Thrift(Binary)&lt;-&gt;Erlang data conversion.</p>
 
  <p>For most purposes, these functions are not called by code outside
  of this library: Erlang client &amp; Erlang server application code  
usually have no need to use these functions.</p>
 
  <h3><a name="Links">Links</a></h3>
 
  <ul>
  <li> http://incubator.apache.org/thrift </li>
  </ul>
 
  <h3><a name="Thrift_Basic_Types_(ABNF)">Thrift Basic Types (ABNF)</a></h3>
  <pre>  message        =  message-begin struct message-end
  message-begin  =  method-name message-type message-seqid
  message-end    =  ""
  method-name    =  STRING
  message-type   =  T-CALL/ T-REPLY/ T-EXCEPTION/ T-ONEWAY
  message-seqid  =  I32
 
  struct         =  struct-begin *field field-stop struct-end
  struct-begin   =  struct-name
  struct-end     =  ""
  struct-name    =  STRING
  field-stop     =  T-STOP
 
  field          =  field-begin field-data field-end
  field-begin    =  field-name field-type field-id
  field-end      =  ""
  field-name     =  STRING ;; NOTE: field-name is not written to nor read from the network
  field-type     =  T-STOP/ T-VOID/ T-BOOL/ T-BYTE/ T-I08/ T-I16/ T-I32/ T-U64/ T-I64/ T-DOUBLE/
                    T-BINARY/ T-STRUCT/ T-MAP/ T-SET/ T-LIST
  field-id       =  I16
  field-data     =  BOOL/ I08/ I16/ I32/ U64/ I64/ DOUBLE/ BINARY/
                    struct/ map/ list/ set
  field-datum    =  field-data field-data
 
  map            =  map-begin *field-datum map-end
  map-begin      =  map-key-type map-value-type map-size
  map-end        =  ""
  map-key-type   =  field-type
  map-value-type =  field-type
  map-size       =  I32
 
  list           =  list-begin *field-data list-end
  list-begin     =  list-elem-type list-size
  list-end       =  ""
  list-elem-type =  field-type
  list-size      =  I32
 
  set            =  set-begin *field-data set-end
  set-begin      =  set-elem-type set-size
  set-end        =  ""
 
  set-elem-type  =  field-type
  set-size       =  I32</pre>
 
  <h3><a name="Thrift_(Binary)_Core_Types_(ABNF)">Thrift (Binary) Core Types (ABNF)</a></h3>
  <pre>  BOOL           =  %x00/ %x01         ; 8/integer-signed-big
  BYTE           =  OCTET              ; 8/integer-signed-big
  I08            =  OCTET              ; 8/integer-signed-big
  I16            =  2*OCTET            ; 16/integer-signed-big
  I32            =  4*OCTET            ; 32/integer-signed-big
  U64            =  8*OCTET            ; 64/integer-unsigned-big
  I64            =  8*OCTET            ; 64/integer-signed-big
  DOUBLE         =  8*OCTET            ; 64/float-signed-big
  STRING         =  I32 UTF8-octets
  BINARY         =  I32 *OCTET
 
  T-CALL         =  %x01
  T-REPLY        =  %x02
  T-EXCEPTION    =  %x03
  T-ONEWAY       =  %x04
 
  T-STOP         =  %x00
  T-VOID         =  %x01
  T-BOOL         =  %x02
  T-BYTE         =  %x03
  T-I08          =  %x05
  T-I16          =  %x06
  T-I32          =  %x08
  T-U64          =  %x09
  T-I64          =  %x0a
  T-DOUBLE       =  %x04
  T-BINARY       =  %x0b
  T-STRUCT       =  %x0c
  T-MAP          =  %x0d
  T-SET          =  %x0e
  T-LIST         =  %x0f</pre>
 
  <h3><a name="Mapping:_Thrift_Types_(Erlang)">Mapping: Thrift Types (Erlang)</a></h3>
  <pre>  tbf::message() = {'message', tbf::method_name(), tbf::message_type(), tbf::message_seqid(), tbf::struct()}.
  tbf::method_name() = binary().
  tbf::message_type() = 'T-CALL' | 'T-REPLY' | 'T-EXCEPTION' | 'T-ONEWAY'.
  tbf::message_seqid() = integer().
 
  tbf::struct() = {'struct', tbf::struct_name(), [tbf::field()]}.
  tbf::struct_name() = binary().
 
  tbf::field() = {'field', tbf::field_name(), tbf::field_type(), tbf::field_id(), tbf::field_data()}.
  tbf::field_name() = binary().
  tbf::field_type() = 'T-STOP' | 'T-VOID' | 'T-BOOL' | 'T-BYTE'
                    | 'T-I08' | 'T-I16' | 'T-I32' | 'T-U64' | 'T-I64' | 'T-DOUBLE'
                    | 'T-BINARY' | 'T-STRUCT' | 'T-MAP' | 'T-SET' | 'T-LIST'.
  tbf::field_id() = integer().
  tbf::field_data() = tbf::void() | tbf::boolean() | integer()
                    | integer() | float()
                    | binary() | tbf::struct() | tbf::map() | tbf::set() | tbf::list().
 
  tbf::map() = {'map', tbf::map_type(), [tbf::map_data()]}.
  tbf::map_type() = {tbf::field_type(), tbf::field_type()}.
  tbf::map_data() = {tbf::field_data(), tbf::field_data()}.
 
  tbf::set() = {'set', tbf::set_type(), [tbf::set_data()]}.
  tbf::set_type() = tbf::field_type().
  tbf::set_data() = tbf::field_data().
 
  tbf::list() = {'list', tbf::list_type(), [tbf::list_data()]}.
  tbf::list_type() = tbf::field_type().
  tbf::list_data() = tbf::field_data().
 
  tbf::void() = 'undefined'.
  tbf::boolean() = 'true' | 'false'.</pre>
 
  <h3><a name="Mapping:_UBF_Types_(Erlang)">Mapping: UBF Types (Erlang)</a></h3>
  <pre>  ubf::tuple() = tuple().
 
  ubf::list() = list().
 
  ubf::number = integer() | float().
 
  ubf::string() = {'$S', [integer()]}.
 
  ubf::proplist() = {'$P', [{term(), term()}]}.
 
  ubf::binary() = binary().
 
  ubf::boolean() = 'true' | 'false'.
 
  ubf::atom() = atom().
 
  ubf::record() = record().
 
  ubf::term() = ubf::tuple() | ubf::list() | ubf::number()
              | ubf::string() | ubf::proplist() | ubf::binary()
              | ubf::boolean() | ubf::atom() | ubf::record().
 
  ubf::state() = ubf::atom().
 
  ubf::request() = ubf::term().
 
  ubf:response() = {ubf::term(), ubf::state()}. % {Reply,NextState}</pre>
 
  <h3><a name="UBF_Messages">UBF Messages</a></h3>
  <pre>  Remote Procedure Call (Client -&gt; Server -&gt; Client)
    ubf::request() =&gt; ubf::response().
 
  Asynchronous Event (Server -&gt; Client)
    'EVENT' =&gt; ubf::term().
 
  Asynchronous Event (Server &lt;- Client)
    'EVENT' &lt;= ubf::term().</pre>
 
  <h3><a name="Mapping:_Thrift_Messages&lt;->UBF_Messages">Mapping: Thrift Messages&lt;-&gt;UBF Messages</a></h3>
  <pre>  Remote Procedure Call (Client -&gt; Server -&gt; Client)
   ubf::request() = {tbf::method_name(), tbf::message_seqid(), tbf::struct()}.
   ubf::response() = {'T-REPLY', tbf::struct()} | {'T-EXCEPTION', tbf::struct()}.
 
  Asynchronous Event (Server -&gt; Client)
    ubf:term() = {tbf::method_name(), tbf::message_seqid(), tbf::struct()}.
 
  Asynchronous Event (Server &lt;- Client)
    ubf:term() = {tbf::method_name(), tbf::message_seqid(), tbf::struct()}.</pre>
 
   <p>NOTE: message_type() is not passed to the Erlang server   
implementation.</p>
 
   <p>NOTE: Thrift has no concept of a UBF 'state name' so it is hidden   
from the Thrift client.</p>
 
   TBD: How to handle the following error cases?
   <ul>
   <li> encoding/decoding errors </li>
   <li> server breaks contract </li>
   <li> client breaks contract </li>
   </ul>
 
  <h3><a name="Mapping:_Thrift_Types&lt;->_UBF_'Native'_Types">Mapping: Thrift Types&lt;-&gt; UBF 'Native' Types</a></h3>
  <pre>  ubf::tuple() = {'struct', &lt;&lt;"$T"&gt;&gt;, [{'field', &lt;&lt;&gt;&gt;, 'T-LIST', 1, {'list', 'T-STRUCT', [ubf::term()]}}]{1} }.
 
  ubf::list() = {'struct', &lt;&lt;"$L"&gt;&gt;, [{'field', &lt;&lt;&gt;&gt;, 'T-LIST', 1, {'list', 'T-STRUCT', [ubf::term()]}}]{1} }.
 
  ubf::number = {'struct', &lt;&lt;"$N"&gt;&gt;, [{'field', &lt;&lt;&gt;&gt;, 'T-I64', 1, integer()}]{1} | [{'field', &lt;&lt;&gt;&gt;, 'T-DOUBLE', 1, float()}]{1} }.
 
  ubf::string() = {'struct', &lt;&lt;"$S"&gt;&gt;, [{'field', &lt;&lt;&gt;&gt;, 'T-BINARY', 1, binary()}]{1} }.
 
  ubf::proplist() = {'struct', &lt;&lt;"$P"&gt;&gt;, [{'field', &lt;&lt;&gt;&gt;, 'T-MAP', 1, {'map', 'T-STRUCT', 'T-STRUCT', [{ubf::term(),ubf::term()}]}}]{1} }.
 
  ubf::binary() = {'struct', &lt;&lt;"$B"&gt;&gt;, [{'field', &lt;&lt;&gt;&gt;, 'T-BINARY', 1, binary()}]{1} }.
 
  ubf::boolean() = {'struct', &lt;&lt;"$O"&gt;&gt;, [{'field', &lt;&lt;&gt;&gt;, 'T-BOOL', 1, boolean()}]{1} }.
 
  ubf::atom() = {'struct', &lt;&lt;"$A"&gt;&gt;, [{'field', &lt;&lt;&gt;&gt;, 'T-BINARY', 1, binary()}]{1} }.
 
  ubf::record() = {'struct', &lt;&lt;"$R"&gt;&gt;, [{'field', &lt;&lt;&gt;&gt;, 'T-MAP', 1, {'map', 'T-BINARY', 'T-STRUCT', [{binary(),ubf::term()}]}}]{1} }.
    NOTE: A record's name is stored by a special key {&lt;&lt;&gt;&gt;, ubf::atom()} in the map.
 
  ubf::term() = ubf::tuple() | ubf::list() | ubf::number()
              | ubf::string() | ubf::proplist() | ubf::binary()
              | ubf::boolean() | ubf::atom() | ubf::record().
 
  ubf::state() = ubf::atom().
 
  ubf::request() = ubf::term().
 
  ubf:response() = {ubf::term(), ubf::state()}. % {Reply,NextState}</pre>
 
  <h3><a name="Mapping:_Thrift_Messages&lt;->UBF_'Native'_Messages">Mapping: Thrift Messages&lt;-&gt;UBF 'Native' Messages</a></h3>
  <pre>  Remote Procedure Call (Client -&gt; Server -&gt; Client)
   ubf::request() = {&lt;&lt;'$UBF'&gt;&gt;, tbf::message_seqid(), ubf::term()}.
   ubf::response() = {'T-REPLY', ubf::term()}.
 
  Asynchronous Event (Server -&gt; Client)
    ubf:term() = {&lt;&lt;'$UBF'&gt;&gt;, tbf::message_seqid(), ubf::term()}.
 
  Asynchronous Event (Server &lt;- Client)
    ubf:term() = {&lt;&lt;'$UBF'&gt;&gt;, tbf::message_seqid(), ubf::term()}.</pre>
 
<h2><a name="index">Function Index</a></h2>
<table width="100%" border="1" cellspacing="0" cellpadding="2" summary="function index"><tr><td valign="top"><a href="#atom_to_binary-1">atom_to_binary/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#binary_to_existing_atom-1">binary_to_existing_atom/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#contract_records-0">contract_records/0</a></td><td></td></tr>
<tr><td valign="top"><a href="#decode-1">decode/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#decode-2">decode/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#decode-3">decode/3</a></td><td></td></tr>
<tr><td valign="top"><a href="#decode_init-0">decode_init/0</a></td><td></td></tr>
<tr><td valign="top"><a href="#decode_print-1">decode_print/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#decode_print-2">decode_print/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#encode-1">encode/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#encode-2">encode/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#encode_print-1">encode_print/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#encode_print-2">encode_print/2</a></td><td></td></tr>
</table>

<h2><a name="functions">Function Details</a></h2>

<h3 class="function"><a name="atom_to_binary-1">atom_to_binary/1</a></h3>
<div class="spec">
<p><tt>atom_to_binary(X) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="binary_to_existing_atom-1">binary_to_existing_atom/1</a></h3>
<div class="spec">
<p><tt>binary_to_existing_atom(X) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="contract_records-0">contract_records/0</a></h3>
<div class="spec">
<p><tt>contract_records() -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="decode-1">decode/1</a></h3>
<div class="spec">
<p><tt>decode(X) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="decode-2">decode/2</a></h3>
<div class="spec">
<p><tt>decode(X, Mod) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="decode-3">decode/3</a></h3>
<div class="spec">
<p><tt>decode(X, Mod, X3) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="decode_init-0">decode_init/0</a></h3>
<div class="spec">
<p><tt>decode_init() -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="decode_print-1">decode_print/1</a></h3>
<div class="spec">
<p><tt>decode_print(X) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="decode_print-2">decode_print/2</a></h3>
<div class="spec">
<p><tt>decode_print(X, Mod) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="encode-1">encode/1</a></h3>
<div class="spec">
<p><tt>encode(X) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="encode-2">encode/2</a></h3>
<div class="spec">
<p><tt>encode(X, Mod) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="encode_print-1">encode_print/1</a></h3>
<div class="spec">
<p><tt>encode_print(X) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="encode_print-2">encode_print/2</a></h3>
<div class="spec">
<p><tt>encode_print(X, Mod) -&gt; any()</tt></p>
</div>
<hr>

<div class="navbar"><a name="#navbar_bottom"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<p><i>Generated EDoc, $Id$</i></p>
</body>
</html>
